#!/bin/bash

/usr/bin/gdalbuildvrt -vrtnodata 256 -r nearest vrt_merged_raster.vrt ESM2012_Rel2017_200km_2p5m_N22E32/200km_2p5m_N22E32/200km_2p5m_N22E32.TIF ESM2012_Rel2017_200km_2p5m_N24E30/200km_2p5m_N24E30/200km_2p5m_N24E30.TIF ESM2012_Rel2017_200km_2p5m_N18E28/200km_2p5m_N18E28/200km_2p5m_N18E28.TIF ESM2012_Rel2017_200km_2p5m_N20E36/200km_2p5m_N20E36/200km_2p5m_N20E36.TIF ESM2012_Rel2017_200km_2p5m_N24E26/200km_2p5m_N24E26/200km_2p5m_N24E26.TIF ESM2012_Rel2017_200km_2p5m_N10E16/200km_2p5m_N10E16/200km_2p5m_N10E16.TIF ESM2012_Rel2017_200km_2p5m_N20E32/200km_2p5m_N20E32/200km_2p5m_N20E32.TIF ESM2012_Rel2017_200km_2p5m_N22E36/200km_2p5m_N22E36/200km_2p5m_N22E36.TIF ESM2012_Rel2017_200km_2p5m_N20E30/200km_2p5m_N20E30/200km_2p5m_N20E30.TIF ESM2012_Rel2017_200km_2p5m_N18E32/200km_2p5m_N18E32/200km_2p5m_N18E32.TIF ESM2012_Rel2017_200km_2p5m_N24E32/200km_2p5m_N24E32/200km_2p5m_N24E32.TIF ESM2012_Rel2017_200km_2p5m_N22E30/200km_2p5m_N22E30/200km_2p5m_N22E30.TIF ESM2012_Rel2017_200km_2p5m_N16E28/200km_2p5m_N16E28/200km_2p5m_N16E28.TIF ESM2012_Rel2017_200km_2p5m_N22E34/200km_2p5m_N22E34/200km_2p5m_N22E34.TIF

# -stats
echo "-stats omitted"
GDAL_CACHEMAX=16240  GDAL_NUM_TRHEADS=4 /usr/bin/gdal_translate -ot UInt16 -of Gtiff -r nearest -mo DataRepresentation=THEMATIC -mo DataType=Thematic -mo BandName=Band_1 -co BIGTIFF=YES -co COMPRESS=LZW -co TFW=YES vrt_merged_raster.vrt spain_merged.tif

/usr/bin/gdaladdo -r nearest -ro --config COMPRESS_OVERVIEW LZW --config BIGTIFF_OVERVIEW IF_SAFER --config USE_RRD NO --config GDAL_NUM_TRHEADS 4 --config TILED YES --config GDAL_CACHEMAX 16240 spain_merged.tif 2 4 8 16 32 64 128 256 512 1024 2048 4096

/usr/bin/gdalinfo -stats -hist spain_merged.tif
